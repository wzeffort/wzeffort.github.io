+++
date = '2024-12-10T00:22:09+08:00'
draft = false
title = 'Termux å®‰è£…æ¡Œé¢ç¯å¢ƒ'
+++

# Termux å®‰è£…æ¡Œé¢ç¯å¢ƒ

> **å‰è¨€**ï¼šå®‰å“å¹³æ¿ä½¿ç”¨Termuxå®‰è£…Linuxæ¡Œé¢æŠ˜è…¾è®°å½•



> ç›®å‰çš„å¹³æ¿ç”µè„‘å±å¹•å°ºå¯¸éƒ½å˜å¾—å¾ˆå¤§ï¼Œå¹¶ä¸”**8+256**çš„é…ç½®ä¹Ÿå¾ˆå¸¸è§ã€‚
> 
> å¦‚æœä½ ä¹Ÿå’Œæˆ‘ä¸€æ ·æ‹¥æœ‰ä¸€å°å±å¹•ä¸ºğŸ˜**13è‹±å¯¸**ğŸ˜çš„å¹³æ¿ç”µè„‘ï¼Œä¸”æœ‰**é”®ç›˜**å’Œ**è“ç‰™é¼ æ ‡**ï¼Œé‚£ä¹ˆåœ¨ä¸Šé¢åˆ©ç”¨å®‰è£…`Termux`å®‰è£…ä¸€ä¸ªå¸¦æœ‰æ¡Œé¢çš„`Linux`ç¯å¢ƒå®åœ¨æ˜¯å¤ªæ–¹ä¾¿äº†ğŸ§¨ï¼ï¼ï¼

## çŸ¥è¯†ç‚¹é€Ÿè§ˆ

**1. å›¾å‹åŒ–å®ç°æ–¹å¼**

- [ ] VNC

- [x] X11ï¼ˆtermux-x11ï¼‰

> ç›®å‰`Termux-X11`è¿™ä¸ªé¡¹ç›®å·²ç»å¼€å‘çš„å¾ˆå®Œå–„äº†ï¼Œå¯åŠ¨æ–¹å¼æ¯”èµ·VNCæ›´ç®€å•ä¸æ»‘

**2. Linuxæ¡Œé¢**

- [x] XFCE

- [x] LXQt

> `XFCE`å’Œ`LXQt`éƒ½å¾ˆä¸é”™ï¼Œä¸ªäººæ„Ÿè§‰æ¥è¯´`LXQt`æ›´è½»é‡æ›´æµç•…ä¸€äº›ï¼Œ`XFCE`åˆ™æ˜¯ä¸»é¢˜æ›´å¤šæ›´æ¼‚äº®

**3. æ¡Œé¢ç¯å¢ƒ**

- [ ] Termux

- [x] Proot-distro

> æœ¬æ–‡æ’°å†™æ—¶`Termux`è¿˜æ²¡èƒ½æ”¯æŒ`locale`ä»¥åŠ`Fcitx5`åŒ…ï¼Œæ‰€ä»¥æ²¡åŠæ³•è¿›è¡Œç³»ç»Ÿä¸­æ–‡åŒ–ï¼ˆLXQtå¯ä»¥ç»™æ¡Œé¢ç»„ä»¶å•ç‹¬è®¾ç½®ï¼ŒXFCEä¸è¡Œï¼‰ï¼Œæ›´ä¸¥é‡çš„æ˜¯æ²¡æœ‰`Fcitx5`æˆ–è€…å…¶ä»–èƒ½å¤Ÿæ”¯æŒä¸­æ–‡è¾“å…¥æ³•çš„åŒ…å¯¹ä¸­æ–‡ç”¨æˆ·å¤ªè‡´å‘½äº†ï¼Œæ²¡æœ‰å®ç”¨æ€§ã€‚æ‰€ä»¥æœ¬æ–‡æœ¬ç€å®ç”¨åŸåˆ™é€‰æ‹©`Proot-distro`å®¹å™¨è¿™ç§æ–¹å¼ã€‚

**å¤‡æ³¨**ï¼šå¦‚æœä»…ä»…æ˜¯ç”¨æ¥è·‘ä¸€äº›exeæ ¼å¼çš„åº”ç”¨ï¼Œä¾‹å¦‚åœ¨å¹³æ¿ç”µè„‘ä¸Šç©å„¿Windowsä¸‹çš„å°æ¸¸æˆé‚£ä¹ˆé€‰å–`Termux`ä¹Ÿæœªå°ä¸å¯ï¼Œå¦‚æœä½ é‡‡ç”¨è¿™ç§æ–¹å¼ï¼Œè¿™é‡Œå¼ºçƒˆæ¨è[**termux-desktop** @by sabamdarif](https://github.com/sabamdarif/termux-desktop)è¿™ä¸ªé¡¹ç›®ã€‚

**å¤‡æ³¨**ï¼šæ­¤å¤–æ’°å†™è¿™ç¯‡ç¬”è®°çš„æ—¶å€™[GitHub - termux/termux-packages](https://github.com/termux/termux-packages)ä»“åº“ä¸­æ­£æœ‰äººå°è¯•æ·»åŠ `Fcitx5`æ”¯æŒï¼Œä¸€æ—¦è¿™é¡¹å·¥ä½œå®Œæˆé‚£ä¹ˆTermuxåŸç”Ÿæ¡Œé¢ä¹Ÿå¯ä»¥åˆ—å…¥å¾…é€‰ã€‚

**4. Linuxå‘è¡Œç‰ˆ**

- [ ] `alpine`: Alpine Linux (edge)

- [ ] `archlinux`: Arch Linux ARM

- [ ] `artix`: Artix Linux (AArch64 only)

- [ ] `chimera`: Chimera Linux (20240707)

- [x] `debian`: Debian (stable)

- [ ] `debian-oldstable`: Debian (old stable)

- [ ] `deepin`: Deepin (beige)

- [ ] `fedora`: Fedora 40 (64bit only)

- [ ] `manjaro`: Manjaro (AArch64 only)

- [ ] `openkylin`: OpenKylin (Yangtze)

- [ ] `opensuse`: OpenSUSE (Tumbleweed)

- [ ] `pardus`: Pardus (yirmibir)

- [ ] `ubuntu`: Ubuntu (24.04)

- [ ] `ubuntu-oldlts`: Ubuntu (22.04)

- [ ] `void`: Void Linux

> `Deepin`ç³»ç»Ÿçš„ddeæ¡Œé¢å¾ˆé€‚åˆä¸­å›½ç”¨æˆ·ï¼Œä½†æ˜¯ç”±äº`Proot-distro` æ˜¯åŸºäº`SysVinit` è€Œddeæ¡Œé¢ç¡®å¿…é¡»ä¾èµ–äº`Systemd`æ‰€ä»¥æ²¡å¿…è¦é€‰æ‹©deepinï¼Œæœ‰å…³è¿™ä¸ªå‘è¡Œç‰ˆçš„æ•™ç¨‹æ–‡ç« å¤ªå°‘äº†ã€‚



> ä¸Šè¿°å‘è¡Œç‰ˆä¸­æ•™ç¨‹æœ€å¤šçš„åº”è¯¥æ˜¯`Ubuntu`ï¼Œä½†æ˜¯`Ubuntu 22.04`ä¹‹åå¼€å§‹å¼ºåˆ¶ä½¿ç”¨`snap`å®‰è£…åº”ç”¨ï¼Œè€Œ`snap`ï¼Œ`Appimage`ä»¥åŠ`Flatpak`ç­‰å·¥å…·åœ¨PRootç¯å¢ƒä¸‹ä¸èƒ½ä½¿ç”¨ã€‚ç”±äº`Ubuntu`å’Œ`Debian`äºŒè€…çš„é…ç½®å¤§è‡´ä¸€è‡´ï¼Œä¸”å…¶ä»–æœ‰å…³`Ubuntu`çš„å‚è€ƒèµ„æ–™ä¹Ÿå¯ä»¥è½»æ¾çš„ç±»æ¯”åˆ°`Debian`ï¼Œæ‰€ä»¥æœ¬æ•™ç¨‹æœ€ç»ˆé‡‡ç”¨`Debian`æ›¿ä»£`Ubuntu`ã€‚



> è‡³äºå…¶ä»–å‘è¡Œç‰ˆåœ¨`Termux`ä¸­å°è¯•ä½¿ç”¨çš„äººè¾ƒå°‘ï¼Œé¿å…è¸©å‘ä¸è€ƒè™‘ã€‚

## Termux é…ç½®

å¯ç”¨`X11`ä»“åº“å’Œ`root`ä»“åº“

```shell

pkg install x11-repo root-repo -y
```

å®é™…ä½¿ç”¨ä¸­æˆ‘ä»¬å¸¸éœ€è¦è®¿é—®å®‰å“ç›®å½•ä¸‹çš„`Downloads`ï¼Œ`Video`ç­‰æ–‡ä»¶å¤¹ï¼Œæ‰€ä»¥éœ€è¦ç»™Termuxå­˜å‚¨æƒé™ï¼Œæ–¹ä¾¿æˆ‘ä»¬åœ¨`Android`å’Œ`Linux`ä¹‹é—´å…±äº«æ–‡ä»¶ã€‚

```bash
# è·å–å­˜å‚¨æƒé™
termux-setup-storage## proot-distroå®‰è£…Linuxå‘è¡Œç‰ˆ
```

éœ€è¦å®‰è£…ç›¸å…³åŒ…æ¥æ”¯æŒåŸºç¡€åŠŸèƒ½

- **termux-x11-nightly**ï¼š`Texmux-X11`è½¯ä»¶çš„é€šä¿¡é…åˆåŒ…

- **pulseaudio**ï¼šæä¾›åœ¨`Linux`ä¸­æ’­æ”¾å£°éŸ³æ”¯æŒ

- **virglrenderer-android**ï¼šåœ¨ `Termux` ä¸Šä½¿ç”¨ç¡¬ä»¶`GPU `åŠ é€Ÿçš„ `PRoot` å®¹å™¨

- **termux-am**ï¼šå®‰è£…åå¯ä»¥ä½¿ç”¨amå‘½ä»¤æ‰“å¼€è®¾å¤‡ä¸Šçš„å…¶ä»–è½¯ä»¶ï¼Œè¿™é‡Œç”¨æ¥ç»™è„šæœ¬æä¾›è‡ªåŠ¨è·³è½¬åˆ°X11ç•Œé¢çš„åŠŸèƒ½

- **tmux**ï¼šä¸€ä¸ªå¼ºå¤§çš„ç»ˆç«¯å¤ç”¨å™¨ï¼Œè¿™é‡Œç”¨æ¥åœ¨`Termuxç»ˆç«¯`å’Œ`Proot-distroç»ˆç«¯`ä¹‹é—´åˆ‡æ¢

- **proot-distro**ï¼šæ— éœ€Rootæä¾›ä¸€ä¸ªç›¸è¾ƒ`Termuxç¯å¢ƒ`æ›´åŠ å®Œæ•´çš„`Linuxç¯å¢ƒ`ï¼Œå¹¶ä¸”åªéœ€è¦æ¶ˆè€—æå°‘çš„æ€§èƒ½

```bash
# å®‰è£…æ¡Œé¢ç›¸å…³è½¯ä»¶
pkg install termux-x11-nightly pulseaudio virglrenderer-android termux-am tmux proot-distro -y 
```

## Proot-distro å®¹å™¨é…ç½®

### å®‰è£…Linuxå‘è¡Œç‰ˆ

ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…Debian

```bash
proot-distro install debian
```

æ¥ä¸‹æ¥éœ€è¦è¿›å…¥debianå®¹å™¨è¿›è¡Œä¸€äº›é…ç½®(æ­¤å°ç»“ä¹‹åå†…å®¹éƒ½åœ¨å®¹å™¨å†…è¿›è¡Œ)

```bash
proot-distro login debian
```

### aptæ¢æº

åç»­å®‰è£…æ¡Œé¢ç¯å¢ƒçš„åŒ…æ¯”è¾ƒå¤§ï¼Œå…ˆç»™aptè¿›è¡Œæ¢æº



é‡‡ç”¨ [ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦](https://www.ustc.edu.cn/)çš„é•œåƒï¼Œè¿™é‡Œç»™å‡ºDebianå’ŒUbuntu Portsï¼ˆå¦‚æœä½ ä½¿ç”¨Ubuntuï¼‰é•œåƒä½¿ç”¨å¸®åŠ©ç½‘å€ï¼Œå¦‚æœä¸‹æ–¹ä¿¡æ¯å¤±æ•ˆï¼Œæˆ–è€…éœ€è¦æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯å¯ä»¥ä½¿ç”¨



[Debian - USTC Mirror Help](https://mirrors.ustc.edu.cn/help/debian.html)

[Ubuntu Ports - USTC Mirror Help](https://mirrors.ustc.edu.cn/help/ubuntu-ports.html)

```bash
# å›½å†…æºé‡‡ç”¨httpsï¼Œå®‰è£…å¿…è¦çš„åŒ…æ”¯æŒhttps
sudo apt install apt-transport-https ca-certificates

# ç¼–è¾‘sources.listæ–‡ä»¶
nano /etc/apt/sources.list

```

ä½¿ç”¨"`#`"æ³¨é‡Šæ‰sources.listä¹‹å‰å­˜åœ¨çš„å†…å®¹ï¼Œé‡æ–°å†™å…¥æ–°å†…å®¹ï¼Œè¿™é‡Œä½¿ç”¨é•œåƒ

```bash
# /etc/apt/sources.list
# é»˜è®¤æ³¨é‡Šäº†æºç ä»“åº“ï¼Œå¦‚æœ‰éœ€è¦å¯è‡ªè¡Œå–æ¶ˆæ³¨é‡Š
deb http://mirrors.ustc.edu.cn/debian bookworm main contrib non-free non-free-firmware
# deb-src http://mirrors.ustc.edu.cn/debian bookworm main contrib non-free non-free-firmware
deb http://mirrors.ustc.edu.cn/debian bookworm-updates main contrib non-free non-free-firmware
# deb-src http://mirrors.ustc.edu.cn/debian bookworm-updates main contrib non-free non-free-firmware

# backports è½¯ä»¶æºï¼Œè¯·æŒ‰éœ€å¯ç”¨
# deb http://mirrors.ustc.edu.cn/debian bookworm-backports main contrib non-free non-free-firmware
# deb-src http://mirrors.ustc.edu.cn/debian bookworm-backports main contrib non-free non-free-fian.html
```

aptæ›´æ–°åŒ…

```bash
apt update; apt-get update
```



### ä¸­æ–‡ç¯å¢ƒé…ç½®

é¦–å…ˆé…ç½®ç³»ç»Ÿä¸­æ–‡ï¼Œå®‰è£…è¯­è¨€ç¯å¢ƒä»¥åŠæ–‡æ³‰é©¿å­—ä½“ï¼ˆä¸­æ–‡å­—ä½“ï¼‰

```
sudo apt install locales fonts-wqy-zenhei -y
```

 ç”Ÿæˆåœ°åŒºè®¾ç½®

```
sudo dpkg-reconfigure locales
# é€‰æ‹©97. en_US.UTF-8 UTF-8
# å›è½¦åé€‰æ‹©3. en_US.UTF-8
# ç›¸å½“äºnano /etc/locale.genå–æ¶ˆæ³¨é‡Šen_US.UTF-8 UTF-8å,locale-gen
```

### é…ç½®è¾“å…¥æ³•

å®‰è£…Fcitx5ä»¥åŠä¸­æ–‡è¾“å…¥æ³•

```bash
apt install fcitx5 fcitx5-chinese-addons fcitx5-frontend-gtk4 fcitx5-frontend-gtk3 fcitx5-frontend-gtk2 fcitx5-frontend-qt5
```

é…ç½®ä½¿ç”¨Fcitx5

æ‰“å¼€é…ç½®æ–‡ä»¶`/etc/profile`(ä¹Ÿå¯ä»¥å†™å…¥`~/.bashrc`æˆ–è€…`~/.profile`,åŒºåˆ«è§[é™„å½•-Fcitx5é…ç½®](#Fcitx5é…ç½®)

```bash
nano /etc/profile
```

åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ä»¥ä¸‹å†…å®¹

```
export XMODIFIERS=@im=fcitx
export GTK_IM_MODULE=fcitx 
export QT_IM_MODULE=fcitx
```

### é…ç½®æ™®é€šç”¨æˆ·å¹¶ç»™äºˆrootæƒé™

é»˜è®¤æƒ…å†µä¸‹ä¼šä½¿ç”¨rootè´¦å·ç™»å½•ï¼Œä½†æ˜¯ä¸€äº›è½¯ä»¶ä¼šå‡ºç°æç¤ºæˆ–è€…é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ™®é€šè´¦æˆ·å¹¶èµ‹äºˆrootæƒé™ä½œä¸ºæ—¥å¸¸ä½¿ç”¨çš„è´¦æˆ·



æ–°å¢ç”¨æˆ·

```bash
adduser <user-name>
```

èµ‹äºˆRootæƒé™

```bash
nano /etc/sudoers
```

åœ¨ `root ALL=(ALL:ALL) ALL` ä¹‹åæ·»åŠ  `<user-name>  ALL=(ALL:ALL) ALL` , å°±åƒä¸‹é¢è¿™æ ·ï¼Œè¯·æ³¨æ„è¿™é‡Œæ·»åŠ äº†`NOPASSWD`è¿™ä¸ªé€‰é¡¹ä»¥é¿å…é¢‘ç¹ä½¿ç”¨sudoå‘½ä»¤

```
# User privilege specification
root    ALL=(ALL:ALL) ALL
<user-name>   ALL=(ALL:ALL) NOPASSWD:ALL
```

### å®‰è£…æ¡Œé¢ç¯å¢ƒ

#### XFCE

```bash
apt install xfce
```

#### LXQt

```bash
apt install lxqt
```

**æ³¨æ„**ï¼šå¦‚æœå¼¹å‡ºè¦é€‰æ‹©åœ°åŒºçš„è¯è¯·é€‰æ‹©**5.Asia** --> **69.ShangHai**ï¼Œé”®ç›˜å¸ƒå±€å¯ä»¥é€‰æ‹©**English**æˆ–è€…**Chinese**æ²¡æœ‰åŒºåˆ«ï¼Œè¯­è¨€é€‰é¡¹å¯ä»¥é€‰æ‹©**zh_CN.UTF-8**

å®‰è£…éœ€è¦è¾ƒé•¿ä¸€æ®µæ—¶é—´ï¼ˆæˆ‘çš„è®¾å¤‡è€—æ—¶30minå·¦å³ï¼‰åœ¨è§£å‹`plasma`èµ„æºçš„æ—¶å€™æ ¼å¤–è´¹æ—¶ï¼Œæ„Ÿè§‰å°±åƒè¿›åº¦æ¡å¡äº†ä¸€æ ·ã€‚

### æ·»åŠ å¸¸ç”¨è½¯ä»¶åŒ…æå‡èˆ’é€‚åº¦

æˆ‘æ¨èçš„åº”ç”¨æœ‰ï¼š

- fishï¼šæ›´èˆ’é€‚çš„ç»ˆç«¯ï¼ˆLXQtçš„é»˜è®¤ç»ˆç«¯éƒ½ä¸æ”¯æŒå…¨å½©è‰²ä»¥åŠ â†‘ â†“åˆ‡æ¢æ‰§è¡Œå†å²ï¼ï¼ï¼ï¼‰

- zshï¼šå…·æœ‰å¾ˆå¤šç‰¹æ€§çš„shell

- geanyï¼šç¼–è¾‘å™¨

- code-ossï¼šLinuxç‰ˆçš„VsCode

- synapticï¼šå¯è§†åŒ–çš„åŒ…ç®¡ç†å·¥å…·ï¼ˆè‡ªåŠ¨åˆ›å»ºçš„å¿«æ·æ–¹å¼å¯èƒ½æœ‰è¯¯ï¼Œå‡ºç°æ‰“ä¸å¼€æƒ…å†µéœ€è¦æŒ‰ç…§ä¸‹æ–‡è¿›è¡Œæ›´æ”¹ï¼‰

- firefox-esrï¼šä½¿ç”¨firefoxæµè§ˆç½‘é¡µ

- wps-officeï¼šPCç«¯çš„WPS

**æ³¨æ„**ï¼šå»ºè®®å®‰è£…`synaptic`åç™»å½•æ¡Œé¢ä½¿ç”¨`synaptic`å®‰è£…firefoxã€wpsè¿™äº›åº”ç”¨

è¿™é‡Œç»™å‡ºæœ€å°å®‰è£…ï¼Œå…¶ä»–çš„è‡ªé€‰

```bash
apt install fish
```

### é…ç½®X11æ˜¾ç¤ºå°ºå¯¸

é»˜è®¤æƒ…å†µä¸‹æ˜¾ç¤ºçš„çª—å£æ¯”ä¾‹è¾ƒå°ï¼Œå¯ä»¥åœ¨**termux-x11 App**é‡Œè¿›è¡Œæ›´æ”¹

1. æ‰“å¼€åº”ç”¨

2. é€‰æ‹©Preferences --> Output --> Display resolutionæ›´æ”¹ä¸ºcustom

3. åœ¨æ–°å‡ºç°çš„é€‰é¡¹Display resolutionè¾“å…¥ä½ å¸Œæœ›çš„æ˜¾ç¤ºå°ºå¯¸ï¼Œä¾‹å¦‚æˆ‘çš„æ˜¯1600x1000

æ­¤å¤–ï¼Œå¦‚æœä½ å¸Œæœ›æ“ä½œæ—¶å¯ä»¥å…¨å±ï¼Œå‹¾é€‰ä¸‹æ–¹çš„Fullscreené€‰é¡¹



### è¿›å…¥æ¡Œé¢ç¯å¢ƒ

**æ³¨æ„**ï¼šå¦‚æœä½ æŒ‰ç…§æ•™ç¨‹ä¸€æ­¥æ­¥è¿›è¡Œæ“ä½œï¼Œé‚£ä¹ˆåœ¨ç»§ç»­ä¹‹å‰ä½ éœ€è¦å…ˆé€€å‡ºå®¹å™¨å›åˆ°termuxç¯å¢ƒåç»§ç»­ï¼Œä½¿ç”¨`exit`å‘½ä»¤é€€å‡ºï¼Œä½ å¯ä»¥è¾“å…¥`uname -r`æ¥æ£€æŸ¥æ˜¯å¦æˆåŠŸï¼Œå³è¾“å‡ºå†…å®¹ä¸­æ²¡æœ‰Proot-distroå³å¯



ç´¯ï¼Œç»ˆäºå¯ä»¥æ¾å£æ°”äº†ï¼æ¥ä¸‹æ¥ä½ å°±å¯ä»¥å°è¯•å¯åŠ¨æ¡Œé¢ç¯å¢ƒäº†ã€‚



ä¸ç€æ€¥ä½¿ç”¨è‡ªåŠ¨åŒ–è„šæœ¬ï¼Œæˆ‘ä»¬å…ˆæ‰‹åŠ¨è¾“å…¥å‘½ä»¤è¿›å…¥



åœ¨termuxæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨X11æœåŠ¡

```bash
XDG_RUNTIME_DIR=\${TMPDIR} termux-x11 :1.0 &
```

ç™»å½•Debianç¯å¢ƒï¼Œå¹¶å¯ç”¨`LXQtæ¡Œé¢`

> è¿™é‡Œæˆ‘é‡åˆ°çš„é—®é¢˜æ˜¯å¦‚æœç›´æ¥åœ¨`proot-distro login`çš„åé¢ä½¿ç”¨`-- bash -c`å‚æ•°åœ¨ç™»å½•åè‡ªåŠ¨æ‰§è¡Œå‘½ä»¤çš„è¯Fcitx5éœ€è¦çš„ç¯å¢ƒå˜é‡æ— æ³•æˆåŠŸé…ç½®ï¼Œä¸ªäººçŒœæµ‹æ˜¯æ²¡æœ‰åŠ è½½é…ç½®æ–‡ä»¶ä¹‹å‰å°±å¯åŠ¨äº†Fcitx5å¯¼è‡´ç¼ºå°‘ç¯å¢ƒå˜é‡ï¼Œæ‰€ä»¥åœ¨å¯åŠ¨æ¡Œé¢å‰æ·»åŠ äº†å‘½ä»¤æ¥é‡è½½é…ç½®æ–‡ä»¶

```bash
proot-distro login debian --shared-tmp  -- bash -c 'source /etc/profile; source ~/.barhrc; export PULSE_SERVER=tcp:127.0.0.1; env DISPLAY=:1.0 dbus-launch --exit-with-session startlxqt'
```

æ¥ä¸‹æ¥åˆ‡æ¢åˆ°**termux x11 Appç•Œé¢** åº”è¯¥å°±å¯ä»¥çœ‹åˆ°å¯¹åº”çš„æ¡Œé¢ç¯å¢ƒäº†

**æ³¨æ„**ï¼šå¦‚æœéœ€è¦é€‰æ‹©çª—å£ç®¡ç†å™¨çš„è¯è¯·é€‰æ‹©**xfwm4**ï¼Œè¿™ä¸ªé€‰é¡¹çš„é…ç½®æ–‡ä»¶åœ¨`~/.config/lxqt/session.conf`ä½ å¯ä»¥æ‰‹åŠ¨æ›´æ”¹`window_manager=xfwm4`



ä½ å¯ä»¥æµ‹è¯•ä¸€ä¸‹ä½ çš„æ¡Œé¢æ˜¯å¦èƒ½å¤Ÿæ­£å¸¸å·¥ä½œï¼Œå¦‚æœä»–æ˜¯è‹±æ–‡çš„ä½ å¯ä»¥åœ¨LXQtçš„é…ç½®ä¸­å¿ƒçš„åŒºåŸŸè®¾ç½®ä¸­é€‰æ‹©ç®€ä½“ä¸­æ–‡ï¼ˆæ³¨æ„æ­¤æ›´æ”¹é‡æ–°ç™»å½•åæ‰èƒ½ç”Ÿæ•ˆï¼‰ï¼Œæœ€é‡è¦çš„æ˜¯ä½ åº”è¯¥æµ‹è¯•ä½ çš„è¾“å…¥æ³•æ˜¯å¦å¦‚æœŸå·¥ä½œï¼Œä½ å¯ä»¥ä½¿ç”¨`Ctrl + ç©ºæ ¼`æ¥åˆ‡æ¢ä¸­è‹±æ–‡è¾“å…¥æ³•ã€‚



å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œé‚£ä¹ˆå›åˆ°`Termux`è¾“å…¥`Ctrl + C`ç»ˆæ­¢æ¡Œé¢è¿›ç¨‹ï¼Œä¹‹åä½¿ç”¨`exit`å‘½ä»¤é€€å‡ºå®¹å™¨



## è‡ªåŠ¨åŒ–è„šæœ¬

å¯åŠ¨æ¡Œé¢çš„æŒ‡ä»¤å®åœ¨æ˜¯å¤ªé•¿äº†ï¼Œå¦‚æœæ¯æ¬¡è¾“å…¥æ˜¾ç„¶æ˜¯ä¸åˆé€‚ï¼Œæ¥ä¸‹æ¥åˆ›å»ºè„šæœ¬æ¥ç®€åŒ–å·¥ä½œ

æˆ‘ä»¬å°†ä¼šåˆ›å»ºä¸¤ä¸ªè„šæœ¬

- **btx11**ï¼šbegin Termux X11 å¯åŠ¨Termux X11æ¡Œé¢

- **stx11**ï¼šstop Termux X11 åœæ­¢Termux X11æ¡Œé¢

### btx11

åˆ›å»ºæ–‡ä»¶

```bash
nano ../usr/bin/btx11
```

å†™å…¥ä»¥ä¸‹å†…å®¹ï¼Œæ³¨æ„ä½ éœ€è¦æ›´æ”¹USER_HOME="/home/<your user name>"çš„å†…å®¹ä¸ºä½ ä¹‹å‰åˆ›å»ºçš„æ™®é€šç”¨æˆ·åï¼Œ`tmux new-session -d -s desktop-server "proot-distro login --user`å¤„ä¹Ÿæ˜¯ä¸€æ ·ï¼Œå¦‚æœä½ éœ€è¦ä»¥Rootå¯åŠ¨ï¼Œé‚£ä¹ˆé…ç½®æ˜¯ç”¨æˆ·åä¸ºroot, USER_HOME="/root"

```bash
#!/data/data/com.termux/files/usr/bin/bash

USER_HOME="/home/<your user name>"

# check -o
open_existing=false
while getopts "o" opt; do
  case $opt in
    o)
     open_existing=true
     ;;
    *)
     ;;
  esac
done

# env DISPLAY=:1.0 dbus-launch --exit-with-session startlxqt > /dev/null 2>&1 &
# nohup proot-distro login debian --shared-tmp --bind $HOME/storage/shared/Music:/root/Music --bind $HOME/storage/shared/Download:/root/Download --bind $HOME/storage/shared/Pictures:/root/Pictures --bind $HOME/storage/shared/Videos:/root/Videos --bind $HOME/storage/shared:/root/storage -- bash -c "env DISPLAY=:1.0 dbus-launch --exit-with-session startlxqt" > /dev/null 2>&1 &

if [ "$open_existing" = true ]; then
  # check "desktop-server" tmux session
  if tmux has-session -t desktopserver 2>/dev/null; then
    tmux attach-session -t desktop-server
    exit 0
  else
    echo "no desktop-server opend, open new session now."
    processes=$(pgrep -f com.termux.x11)
    for pid in $processes; do
        echo "killing x11 server: $pid"
        kill $pid
    done
    echo "open new x11 server"
    XDG_RUNTIME_DIR=\${TMPDIR} termux-x11 :1.0 &
    sleep 1
    echo "jump to x11 app"
    am start --user 0 -n com.termux.x11/com.termux.x11.MainActivity > /dev/null 2>&1
    sleep 1
  fi
else
  echo "close old desktop-server tmux session"
  tmux kill-session -t desktop-server

  processes=$(pgrep -f com.termux.x11)
  for pid in $processes; do
      echo "killing x11 server: $pid"
      kill $pid
  done
  echo "open new x11 server"
  XDG_RUNTIME_DIR=\${TMPDIR} termux-x11 :1.0 &
  sleep 1
  echo "jump to x11 app"
  am start --user 0 -n com.termux.x11/com.termux.x11.MainActivity > /dev/null 2>&1
  sleep 1
fi

# close pulseaudio
processes=$(pgrep -f pulseaudio)
for pid in $processes; do
    echo "killing pulseaudio: $pid"
    kill $pid
done

# close virgl renderer
processes=$(grep -f virglrenderer-android)
for pid in $process; do
    echo "killing virglrenderer-android $pid"
    kill $pid
done

echo "Starting pulseaudio server"
pulseaudio --start --load="moudle-native-protocol-tcp auth-ip-acl=127.0.0.1 auth-anonymous=1" --exit-idle-time=-1

echo "Starting Virgl Renderer"
virgl_test_server_android &

echo "open proot-distro desktop"
tmux new-session -d -s desktop-server "proot-distro login --user <your user name> debian --shared-tmp --bind /data/data/com.termux/files/usr:/termux --bind $HOME/storage/shared/Music:$USER_HOME/Music --bind $HOME/storage/shared/Download:$USER_HOME/Downloads --bind $HOME/storage/shared/Pictures:$USER_HOME/Pictures --bind $HOME/storage/shared/Videos:$USER_HOME/Videos --bind $HOME/storage/shared:$USER_HOME/storage -- bash -c 'source /etc/profile; source ~/.barhrc; export PULSE_SERVER=tcp:127.0.0.1; env DISPLAY=:1.0 dbus-launch --exit-with-session startlxqt'"
# --bind /data/data/com.termux/files/usr:/termux 

if [ "$open_existing" = true ]; then
  tmux attach-session -t desktop-server
fi
```

ç»™äºå¯æ‰§è¡Œæƒé™

```bash
chmod +x ../usr/bin/btx11
```

### stx11

åˆ›å»ºæ–‡ä»¶

```bash
nano ../usr/bin/stx11
```

å†™å…¥ä»¥ä¸‹å†…å®¹

```bash
#!/data/data/com.termux/files/usr/bin/bash

processes=$(pgrep -f com.termux.x11)
for pid in $processes; do
    echo "killing x11 server: $pid"
    kill $pid
done
if tmux has-session -t desktop-server 2>/dev/null; then
  echo "killing existing "desktop-server" tmux session"
  tmux kill-session -t desktop-server
fi
```

ç»™äºå¯æ‰§è¡Œæƒé™

```bash
chmod +x ../usr/bin/stx11
```

è¿›è¡Œæµ‹è¯•

å¯åŠ¨æ¡Œé¢

```bash
btx11
```

å…³é—­æ¡Œé¢

```bash
stx11
```

æç¤ºï¼š

1. **btx11**å‘½ä»¤å¯åŠ¨æ¡Œé¢åé»˜è®¤æƒ…å†µä¸‹ä¼šåœ¨åå°çš„`tmux`ç»ˆç«¯ä¸­è¿è¡Œï¼Œä½ å¯ä»¥è¾“å…¥`btx11 -o`æ¥ä¿æŒå®¹å™¨ç»ˆç«¯åœ¨å‰å°è¿è¡Œï¼Œä½¿ç”¨`Ctrl + b`å†æŒ‰ä¸‹`d`å¯ä»¥å›åˆ°`Termux`ç»ˆç«¯ï¼ˆè¯¦è§tmuxæ•™ç¨‹ï¼‰ã€‚

2. åœ¨æ¡Œé¢å·²ç»å¯åŠ¨çš„æƒ…å†µä¸‹ï¼Œ`btx11 -o`ä¼šç›´æ¥è¿›å…¥å¼€å¯çš„å®¹å™¨ç»ˆç«¯ï¼Œ`btx11`ä¼šå…³é—­æ‰€æœ‰å·²æœ‰çš„æ¡Œé¢æœåŠ¡å¹¶é‡æ–°å¯åŠ¨ã€‚

3. **btx11**å‘½ä»¤å¯åŠ¨æ¡Œé¢ä¼šè‡ªåŠ¨å°†å®‰å“ç›®å½•ä¸‹çš„Downloadï¼ŒVideoï¼ŒMusicï¼ŒPicturesæ˜ å°„åˆ°ç”¨æˆ·ç›®å½•ä¸‹ï¼Œæ­¤å¤–storageæ˜ å°„çš„æ˜¯å®‰å“æ–‡ä»¶ç³»ç»Ÿçš„æ ¹ç›®å½•ï¼Œ/termuxæ˜ å°„çš„æ˜¯Termuxä¸‹`$PERFIX/usr`ç›®å½•ï¼Œåœ¨å…¶ä¸­å¯ä»¥çœ‹åˆ°`Termux`çš„æ–‡ä»¶ï¼Œå®‰è£…åœ¨`Termux`ä¸­çš„**åº”ç”¨**å¯ä»¥åœ¨`/termux/bin`ç›®å½•ä¸‹æ‰¾åˆ°ï¼Œè¿™äº›åº”ç”¨åœ¨å®¹å™¨å†…ä¹Ÿå¯ä»¥å¯åŠ¨ï¼Œä½†æ˜¯å„åˆ«æ–¹é¢ä¼šå‡ºç°é—®é¢˜ï¼Œä¾‹å¦‚è¿™äº›åº”ç”¨ä¸­éƒ½æ— æ³•ä½¿ç”¨`Fcitx5`è¾“å…¥æ³•ã€‚



## å¤‡ä»½å’Œè¿˜åŸ

Linuxä¸Windowç›¸æ¯”ç”¨æˆ·çš„æƒé™å°±å¤§äº†å¾ˆå¤šï¼Œæ‰€ä»¥æ—¥å¸¸ä½¿ç”¨å¯èƒ½ä¼šå‡ºç°æŸäº›æ„å¤–å¯¼è‡´ç³»ç»Ÿæ— æ³•æ­£ç¡®è¿è¡Œã€‚ä¸ºäº†é¿å…æ„å¤–æˆ‘ä»¬å¯ä»¥å°†æŸäº›çŠ¶æ€å¤‡ä»½ï¼Œä»¥å¾…å°†æ¥æ¢å¤ã€‚



proot-distroå¯ä»¥å°†æ•´ä¸ªå®¹å™¨çš„å†…å®¹æ‰“åŒ…ä¸ºä¸€ä¸ªgzå‹ç¼©åŒ…ï¼Œä¹‹åå¯ä»¥ä»è¿™ä¸ªå¤‡ä»½æ–‡ä»¶ä¸­æ¢å¤çŠ¶æ€ã€‚

å¤‡ä»½çš„å‘½ä»¤ä¸º

```bash
proot-distro backup debian --output ~/storage/download/debian_back.tar.gz
```

**æ³¨æ„**ï¼š`~/storage/download`æ˜¯æ˜ å°„åˆ°Androidä¸‹çš„Downloadç›®å½•ï¼Œä½ å¯ä»¥æ‰“å¼€æ–‡ä»¶ç®¡ç†å™¨åœ¨å¯¹åº”ä½ç½®æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œä¹‹åå¦¥å–„ä¿å­˜å®ƒã€‚



æ¢å¤çš„å‘½ä»¤ä¸º

```bash
proot-distro restore ~/storage/download/debian_back.tar.gz
```



## é™„å½•

å‚è€ƒäº†è®¸å¤šæ–‡ç« ï¼Œç”±äºæœ‰äº›åšå®¢çš„æœåŠ¡å™¨åœ¨å›½å¤–å¯èƒ½å­˜åœ¨æ‰“ä¸å¼€æƒ…å†µï¼Œä»¥åŠä¸ºäº†é¿å…é“¾æ¥ä¸¢å¤±ï¼Œæˆ‘å°†é‡è¦çš„å‡ ç¯‡æ‘˜å½•åˆ°äº†é™„å½•ä¸­ï¼Œå„é™„å½•å‡æ ‡æ˜äº†åŸæ–‡ç« é“¾æ¥ã€‚

# Systemd å’Œ SysVInitå¯¹æ¯”

> æ‘˜å½•è‡ª[SystemdåŸºç¡€ç¯‡ï¼šsystemd vs SysVinit_systemd sysvinit-CSDNåšå®¢](https://blog.csdn.net/z69183787/article/details/113868288)

Systemdå·²ç»åŸºæœ¬å–ä»£äº†SysVçš„Initï¼Œè¿™ç¯‡æ–‡ç« ä»å‡ ä¸ªæ–¹é¢æ•´ç†ä¸€ä¸‹Systemdä¸Initçš„ä½¿ç”¨ä¸Šçš„åŒºåˆ«ã€‚

## å‘½ä»¤æ¯”è¾ƒ: SysVinit vs Systemd

| å‘½ä»¤ç”¨é€”         | SysVInitå‘½ä»¤            | Systemdå‘½ä»¤                                    |
| ------------ | --------------------- | -------------------------------------------- |
| æœåŠ¡å¯åŠ¨         | service æœåŠ¡å start     | systemctl start æœåŠ¡å.service (.serviceå¯çœç•¥ï¼ŒååŒï¼‰ |
| æœåŠ¡åœæ­¢         | service æœåŠ¡å stop      | systemctl stop æœåŠ¡å                           |
| æœåŠ¡é‡å¯         | service æœåŠ¡å restart   | systemctl restart æœåŠ¡å                        |
| æœåŠ¡é‡æ–°åŠ è½½       | service æœåŠ¡å reload    | systemctl reload æœåŠ¡å                         |
| æœåŠ¡çŠ¶æ€ç¡®è®¤       | service æœåŠ¡å status    | systemctl status æœåŠ¡å                         |
| æœåŠ¡å¼€æœºå¯åŠ¨è®¾å®š     | chkconfig æœåŠ¡å on      | systemctl enable æœåŠ¡å                         |
| å–æ¶ˆæœåŠ¡å¼€æœºå¯åŠ¨è®¾å®š   | chkconfig service off | systemctl disable æœåŠ¡å                        |
| ç¡®è®¤æœåŠ¡å¼€æœºå¯åŠ¨è®¾å®šçŠ¶æ€ | chkconfig æœåŠ¡å         | systemctl is-enabled æœåŠ¡å                     |
| åŠ è½½æœåŠ¡é…ç½®æ–‡ä»¶     | chkconfig æœåŠ¡å -add    | systemctl deamon-reload                      |
| å…³æœº           | halt                  | systemctl halt                               |
| å…³æœºï¼ˆç”µæºï¼‰       | poweroff              | systemctl poweroff                           |
| é‡å¯           | reboot                | systemctl reboot                             |
| ä¼‘çœ            | pm-hibernate          | systemctl hibernate                          |
| æŒ‚èµ·           | pm-suspend            | systemctl suspend                            |

## RunLevel: SysVinit vs Systemd

| RunLevel                                | SysVInit | Systemd                             |
| --------------------------------------- | -------- | ----------------------------------- |
| System halt                             | 0        | runlevel0.target, poweroff.target   |
| Single user mode                        | 1        | runlevel1.target, rescure.target    |
| Multi user                              | 2        | runlevel02target, multi-user.target |
| Multi user with network                 | 3        | runlevel3.target, multi-user.target |
| Experimental                            | 4        | runlevel4.target, multi-user.target |
| Multi user with network, graphical mode | 5        | runlevel5.target, graphical.target  |
| Reboot                                  | 6        | runlevel6.target, reboot.target     |

## æ—¥å¿—ç¡®è®¤æ–¹å¼

### SysVinitæ–¹å¼

- ç¡®è®¤ç³»ç»Ÿæ—¥å¿—æ–‡ä»¶

> æ–‡ä»¶åï¼š /var/log/message  
> æ–‡ä»¶åï¼š/var/log/syslog

### Systemd

- ç¡®è®¤ç³»ç»Ÿæ—¥å¿—ä¿¡æ¯

> ä½¿ç”¨å‘½ä»¤ï¼š journalctl -f

- ç¡®è®¤æŸä¸€æ—¶é—´ç‚¹ä¹‹åçš„æ—¥å¿—ä¿¡æ¯

> ä½¿ç”¨å‘½ä»¤ï¼šjournalctl -since=xxx

## Systemdç‰¹æ®Šå‘½ä»¤

### ç¡®è®¤å¯åŠ¨æ—¶é—´

> ä½¿ç”¨å‘½ä»¤ï¼šsystemd-analyze æˆ–è€… systemd-analyze time

```bash
[root@host ~]# systemd-analyze
Startup finished in 1.638s (kernel) + 1.951s (initrd) + 14.177s (userspace) = 17.767s
[root@host ~]# 
[root@host ~]# systemd-analyze time
Startup finished in 1.638s (kernel) + 1.951s (initrd) + 14.177s (userspace) = 17.767s
[root@host ~]#
```

### åœæ­¢æœåŠ¡ç›¸å…³è¿›ç¨‹

> ä½¿ç”¨å‘½ä»¤ï¼šsystemctl kill æœåŠ¡å

### hostnameè®¾å®š

> ä½¿ç”¨å‘½ä»¤ï¼šhostnamectl

```bash
[root@host shell]# hostnamectl
   Static hostname: host.localdomain
         Icon name: computer-vm
           Chassis: vm
        Machine ID: d27a659b15fc379d24204584d5c051bd
           Boot ID: 3fe84ed9506248b9a41c492ca543748a
    Virtualization: kvm
  Operating System: CentOS Linux 7 (Core)
       CPE OS Name: cpe:/o:centos:centos:7
            Kernel: Linux 4.10.4-1.el7.elrepo.x86_64
      Architecture: x86-64
[root@host shell]# 
[root@host shell]# 
[root@host shell]# hostnamectl set-hostname liumiaocn
[root@host shell]# 
```

å†æ¬¡ç™»å½•ä¹‹åï¼Œhostnameçš„å˜åŒ–å³å¯çœ‹åˆ°

```bash
[root@liumiaocn ~]#
```

### æ—¶é—´è®¾å®š

> ä½¿ç”¨å‘½ä»¤ï¼š timedatectl

æ³¨ï¼šä½¿ç”¨æ–¹æ³•å¯å‚çœ‹ï¼š

- [LinuxåŸºç¡€ï¼štimedatectlå‘½ä»¤ä½¿ç”¨ä»‹ç»-CSDNåšå®¢](https://liumiaocn.blog.csdn.net/article/details/88408155)

### ç®¡ç†loginï¼šloginctrl

> ä½¿ç”¨ä¾‹ï¼šæŸ¥çœ‹å½“å‰ç™»å½•ç”¨æˆ·çš„SessionçŠ¶å†µ

```bash
[root@liumiaocn ~]# loginctl
   SESSION        UID USER             SEAT            
        10          0 root                             

1 sessions listed.
[root@liumiaocn ~]#
```

## ç®¡ç†localeï¼šlocalectl

> ä½¿ç”¨ä¾‹ï¼šæŸ¥çœ‹å½“å‰æœ¬åœ°åŒ–è®¾å®šä¿¡æ¯

```bash
[root@liumiaocn ~]# localectl
   System Locale: LANG=en_US.UTF-8
       VC Keymap: us
      X11 Layout: us
[root@liumiaocn ~]#
```





[Termux:ä»0åˆ°1å®‰è£…æ¡Œé¢ç³»ç»Ÿ(proot-distro)-CSDNåšå®¢](https://blog.csdn.net/m0_75196987/article/details/137704117)

[ğŸ“± åœ¨ Termux ä¸Šä½¿ç”¨ç¡¬ä»¶ GPU åŠ é€Ÿçš„ proot å®¹å™¨ - é¢¨é›ªåŸ](https://blog.chyk.ink/2023/03/19/termux-hw-accelerated-proot/)

[ä½¿ç”¨Termuxå®‰è£…xfce4æ¡Œé¢, Android Studio, Code Server(VSCode) - Alain&#039;s Blog](https://www.alainlam.cn/?p=859)

[Termuxå¦‚ä½•å®‰è£Debianç³»çµ± (åœ–å½¢ç•Œé¢ï¼‹ä¸­æ–‡åŒ–ï¼‹éŸ³è¨Šï¼‹ä¸€éµå•Ÿå‹•æŒ‡ä»¤ç¨¿) &#183; Ivonçš„éƒ¨è½æ ¼](https://ivonblog.com/posts/termux-proot-distro-debian/)

# Fcitx5é…ç½®

> æ‘˜å½•è‡ª [è®¾ç½® Fcitx 5 - Fcitx](https://fcitx-im.org/wiki/Setup_Fcitx_5/zh-cn)

## å¼€æœºè‡ªå¯åŠ¨

### ç‰¹å®šå‘è¡Œç‰ˆä¸­çš„å·¥å…·

ç‰¹å®šçš„å‘è¡Œç‰ˆå¯èƒ½ä¼šæä¾›ä¸€äº›ç”¨äºè‡ªåŠ¨å¯åŠ¨ Fcitx çš„å·¥å…·ï¼Œå¹¶ä¸”è¿™äº›å·¥å…·é€šå¸¸ä¹Ÿä¼šè®¾ç½®ç¯å¢ƒå˜é‡ã€‚

#### im-config (Debian/Debian-based/Ubuntu)

è¿™æ˜¯ä¸€ä¸ªç”¨äº Debian å’Œ Debian-based å‘è¡Œç‰ˆçš„å·¥å…·ã€‚åœ¨ç™»å½•åˆ° GUI ä¹‹åï¼Œä»å‘½ä»¤è¡Œæ‰§è¡Œ `im-config`ï¼Œåº”è¯¥ä¼šå¼¹å‡ºä¸€ä¸ªå‘å¯¼ç¨‹åºï¼Œåœ¨å…¶ä¸­é€‰æ‹© fcitx5 å³å¯ã€‚

#### imsettings (Fedora)

è¿™æ˜¯ä¸€ä¸ªä¸ im-config ç±»ä¼¼çš„ç¨‹åºï¼Œå®ƒä¹Ÿæä¾›äº† GUI æ¥é€‰æ‹©è¦ä½¿ç”¨çš„è¾“å…¥æ³•æ¡†æ¶ã€‚imsettings 
åº”è¯¥æ˜¯è¢«é»˜è®¤å®‰è£…çš„ï¼Œå¦‚æœæ²¡æœ‰ï¼Œä½ å¯ä»¥æ‰‹åŠ¨å®‰è£…å®ƒã€‚imsettings 
å¯ä»¥è®¾ç½®ç¯å¢ƒå˜é‡å¹¶ä¸”å¯åŠ¨ç›¸åº”çš„è¾“å…¥æ³•ï¼Œå®ƒè¿˜æä¾›äº†ä¸€ä¸ªå›¾å½¢åŒ–çš„å‰ç«¯ç”¨äºä¿®æ”¹é…ç½®ã€‚ä½ éœ€è¦åšçš„å°±æ˜¯ç®€å•åœ°æ‰§è¡Œ`im-chooser`ï¼Œlog-out ç„¶åå†æ¬¡ log-inã€‚

[é’ˆå¯¹ Fedora 36 KDE çš„æ“ä½œè¯´æ˜](https://www.youtube.com/watch?v=FwqTtGEN4vQ)ã€‚ è¿™ä¸ªæ“ä½œè¯´æ˜åº”è¯¥é€‚ç”¨äºé™¤ GNOME å¤–çš„ XDG å…¼å®¹æ¡Œé¢ã€‚

#### fcitx5-autostart (Fedora)

è¿™æ˜¯ä¸€ä¸ª [fedora package]ï¼Œæ‰“åŒ…äº†ä¸€ä¸ªç”¨äºè®¾ç½®ç¯å¢ƒå˜é‡å’Œ XDG autostart file çš„ /etc/profile.d è„šæœ¬ï¼Œå¯ç”¨äºè‡ªå¯åŠ¨ã€‚

### XDG Autostart

ç‰¹å®šçš„å‘è¡Œç‰ˆå¯èƒ½æ²¡æœ‰æä¾›è¿™ä¸ªæ–‡ä»¶ï¼Œå¦‚æœªæä¾›ï¼Œä½ å¯ä»¥ç›´æ¥å¤åˆ¶ `/usr/share/applications/org.fcitx.Fcitx5.desktop` åˆ° `~/.config/autostart`

mkdir -p ~/.config/autostart && cp /usr/share/applications/org.fcitx.Fcitx5.desktop ~/.config/autostart

### KWin Wayland 5.24+

å¦‚æœä½ åªä½¿ç”¨ Gtk/Qt/Xwayland åº”ç”¨ï¼Œé‚£ä¹ˆä½ ä¸éœ€è¦è¿™é‡Œçš„æ“ä½œã€‚å¦‚æœä½ å¸Œæœ›ä½¿ç”¨æ”¯æŒ text-input-v3 çš„åŸç”Ÿ wayland åº”ç”¨ï¼Œåˆ™éœ€è¦è®© KWin å°†è¾“å…¥æ³•ä½œä¸ºä¸€ä¸ªç‰¹æ®Šçš„å®¢æˆ·ç«¯å¯åŠ¨ã€‚

æ‰“å¼€ systemsettingsï¼Œè½¬åˆ° "Virtual Keyboard" éƒ¨åˆ†ï¼Œå°†è¾“å…¥æ³•ä» "None" æ”¹ä¸º "Fcitx 5"

### é XDG å…¼å®¹çš„çª—å£ç®¡ç†å™¨/Wayland Compoistor

åœ¨ä¸æ”¯æŒ XDG Autostart çš„åœºæ™¯ä¸­ï¼Œè¯·æ£€æŸ¥ä½ çš„çª—å£ç®¡ç†å™¨çš„æ‰‹å†Œä¸­å…³äºå¦‚ä½•åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨è¿è¡Œåº”ç”¨ç¨‹åºçš„æ–¹æ³•ã€‚

#### Weston

Weston æ˜¯ä¸€ä¸ª wayland compositor çš„å‚è€ƒå®ç°ï¼Œå¹¶ä¸æ˜¯æ™®é€šç”¨æˆ·çš„å¸¸è§„é…ç½®ã€‚

å¦‚æœä½ å¸Œæœ›ä½¿ç”¨ westons zwp_input_method_v1 å®ç°ï¼Œä½ éœ€è¦ç¡®ä¿ä»¥ä¸‹å†…å®¹å­˜åœ¨ ~/.config/weston.ini æ–‡ä»¶ä¸­ï¼ˆå¦‚æœè·¯å¾„ä¸æ˜¯ /usr/bin/fcitx5 è¯·åšç›¸åº”ä¿®æ”¹ï¼‰ã€‚

[input-method]
path=/usr/bin/fcitx5

å¦‚æœä½ å·²ç»åœ¨åŒä¸€ä¸ªä¼šè¯ä¸­è¿è¡Œ fcitx5ï¼Œå½“ä½ ä¸ºäº†è°ƒè¯•å’Œ fcitx5 å°è¯•åœ¨ nested mode ä¸­ä½¿ç”¨ weston æ—¶ï¼Œä¼šå­˜åœ¨ç‰¹å®šçš„é—®é¢˜ã€‚

å¦‚æœä½ å‡ºäºè°ƒè¯•ç›®çš„åªåœ¨ X11 ä¸­è¿è¡Œ westonï¼Œæœ€ç®€å•çš„æ–¹æ³•æ˜¯åœ¨å¯åŠ¨ weston å‰é€€å‡º fcitx5.

å¦è¯·æ³¨æ„ï¼Œweston æœ‰ä¸€ä¸ª bugï¼Œåœ¨é¦–æ¬¡è¿è¡Œæ—¶ä¸ä¼šæ­£ç¡®è®¾ç½® DISPLAY ä¸ºè¾“å…¥æ³•ã€‚æ‚¨å¯èƒ½éœ€è¦ç»ˆæ­¢ fcitx5 ä¸€æ¬¡æ‰èƒ½ä½¿å…¶æ­£ç¡®è®¾ç½® DISPLAYï¼Œæˆ–ä½¿ç”¨ OpenX11Connection dbus è°ƒç”¨æ¥è¿æ¥ fcitxã€‚

## ç¯å¢ƒå˜é‡

ç”±äºè®¸å¤šåœ°æ–¹éƒ½å¤„äºè¿‡æ¸¡é˜¶æ®µï¼Œå› æ­¤æ²¡æœ‰é€‚åˆæ‰€æœ‰äººçš„å®Œç¾è§£å†³æ–¹æ¡ˆã€‚è¯·æ ¹æ®æ‚¨çš„ç¯å¢ƒé€‰æ‹©é€‚åˆæ‚¨çš„è§£å†³æ–¹æ¡ˆã€‚åŸºæœ¬ä¸Šï¼Œæ‚¨æƒ³è¦åšçš„æ˜¯ä¸ºæ¡Œé¢ä¼šè¯è®¾ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ã€‚

 XMODIFIERS=@im=fcitx
 GTK_IM_MODULE=fcitx
 QT_IM_MODULE=fcitx
è™½ç„¶å®ƒçœ‹èµ·æ¥åƒæœ‰æ•ˆçš„ shell è„šæœ¬ï¼Œä½†è¯· *æ³¨æ„* ä¸Šé¢çš„ä»£ç ç‰‡æ®µåªæ˜¯ä¸ºäº†æ¼”ç¤ºè¿™äº›å€¼æ˜¯ä»€ä¹ˆã€‚è¯·æ£€æŸ¥ä»¥ä¸‹éƒ¨åˆ†ä»¥äº†è§£ä¸åŒæ–¹æ³•çš„å…·ä½“è¯­æ³•ã€‚

### ç™»å½• shell é…ç½®æ–‡ä»¶

å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨Bashä½œä¸ºæ‚¨çš„ç™»å½•shellï¼Œ`~/.bash_profile` æ˜¯æ‚¨å¯ä»¥ä¿¡èµ–çš„æœ€å¥½çš„ç”¨æˆ·çº§ä¸œè¥¿ã€‚å®ƒå—åˆ°ä¸åŒ DM çš„å¹¿æ³›æ”¯æŒï¼Œå¦‚æœæ‚¨ä» TTY å¯åŠ¨å›¾å½¢ï¼Œå®ƒä¹Ÿå¯ä»¥å·¥ä½œã€‚

- æ”¯æŒä¸»æµæ˜¾ç¤ºç®¡ç†å™¨ï¼ŒåŒ…æ‹¬GDM/SDDM/LightDM
- TTY ç™»å½•

å¦‚æœæ‚¨ä¸ä½¿ç”¨ bashï¼Œæ‚¨å¯èƒ½éœ€è¦ä»”ç»†æ£€æŸ¥æ‚¨çš„ shell é…ç½®æ–‡ä»¶æ˜¯å¦å¯ä»¥ç”¨ä½œè®¾ç½®ç¯å¢ƒå˜é‡çš„ä½ç½®ï¼Œå°¤å…¶æ˜¯å½“æ‚¨æ­£åœ¨ä½¿ç”¨ä¸€äº›ä¸å¸¸è§çš„ç™»å½• shellæ—¶ã€‚

æ‚¨éœ€è¦æ·»åŠ åˆ° `~/.bash_profile` çš„ä»£ç ç‰‡æ®µå¦‚ä¸‹ï¼š

export XMODIFIERS=@im=fcitx
export GTK_IM_MODULE=fcitx
export QT_IM_MODULE=fcitx

æœ‰äº›äººå¯èƒ½ä¼šè®¤ä¸º `~/.profile` æ˜¯ä¸€ä¸ªä¸ shell æ— å…³çš„è§£å†³æ–¹æ¡ˆï¼Œè¿™æ˜¯é”™è¯¯çš„ã€‚è™½ç„¶ GDM å§‹ç»ˆè·å–æ­¤æ–‡ä»¶ï¼Œä½†å¦‚æœ `~/.bash_profile` å­˜åœ¨ï¼ŒSDDM/Bash å°†ä¸ä¼šè·å–æ­¤æ–‡ä»¶ã€‚è¿™ä½¿å¾— `~/.bash_profile` æˆä¸ºæ›´å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œå› ä¸º bash çš„ä½¿ç”¨ç›¸å½“å¹¿æ³›ã€‚ä½†åœ¨ç»§ç»­ä¹‹å‰è¯·æ£€æŸ¥æ‚¨çš„ç™»å½• shellï¼ŒæŸäº›å‘è¡Œç‰ˆå¯èƒ½ä¸ä½¿ç”¨ bash ä½œä¸ºé»˜è®¤ shellã€‚

æ­¤[è§†é¢‘](https://youtu.be/8XDmLr6wb4M)æ¼”ç¤ºäº†å¦‚ä½•åœ¨ Archlinux ä¸Šæ‰‹åŠ¨è®¾ç½®ç¯å¢ƒå˜é‡

### /etc/profile

å¦‚æœæ‚¨ä¸å…³å¿ƒä½¿ç”¨ root ä¿®æ”¹æ–‡ä»¶ï¼Œè¿™æ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚æ‰€æœ‰å‘è¡Œç‰ˆé€šå¸¸éƒ½æ”¯æŒæ­¤æ–‡ä»¶ã€‚æ‚¨éœ€è¦é™„åŠ åˆ° `/etc/profile` æœ«å°¾çš„ä»£ç ç‰‡æ®µä¸ [ç™»å½•shellé…ç½®æ–‡ä»¶](https://fcitx-im.org/wiki/Special:MyLanguage/Setup_Fcitx_5#Login_in_shell_profile "Special:MyLanguage/Setup Fcitx 5") ç›¸åŒã€‚

### ~/.xprofile

å¦‚æœæ‚¨ä½¿ç”¨ X11 å’Œæ˜¾ç¤ºç®¡ç†å™¨ï¼Œè¿™æ˜¯ä¸€ä¸ªå¤è€çš„å®Œç¾é€‰æ‹©ã€‚ä½† Wayland æ²¡æœ‰å¯¹åº”çš„ç¯å¢ƒå˜é‡ï¼Œå› æ­¤å¦‚æœè¦ä¸º Wayland è®¾ç½®ç¯å¢ƒå˜é‡å¹¶ä¸ç†æƒ³ã€‚æ‚¨è¦æ·»åŠ çš„ä»£ç ä¸[ç™»å½•shellé…ç½®æ–‡ä»¶](https://fcitx-im.org/wiki/Special:MyLanguage/Setup_Fcitx_5#Login_in_shell_profile "Special:MyLanguage/Setup Fcitx 5") ç›¸åŒã€‚

### environment.d

è¿™æ˜¯ system.d å¼•å…¥çš„æ–°é…ç½®ï¼Œä½†å¹¶æœªå¾—åˆ°æ¡Œé¢ç¯å¢ƒæˆ–æ˜¾ç¤ºç®¡ç†å™¨æ”¯æŒçš„å¹¿æ³›ä½¿ç”¨ã€‚å®ƒåŸºæœ¬ä¸Šæ˜¯ systemd 
ç”¨æˆ·å•å…ƒçš„ç¯å¢ƒé…ç½®ã€‚ç›®å‰ï¼Œä»… GDM æˆ– Plasma 5.22+ æ”¯æŒã€‚ä½œä¸º GDMï¼Œè¿™æ„å‘³ç€ä½¿ç”¨ GDM ç™»å½•çš„ä»»ä½•ä¼šè¯éƒ½å¯ä»¥å·¥ä½œã€‚è‡³äº 
Plasmaï¼Œè¿™æ„å‘³ç€æ— è®ºæ‚¨ä½¿ç”¨ä»€ä¹ˆ DMï¼Œå®ƒéƒ½é€‚ç”¨äº Plasmaã€‚

æ­¤é…ç½®å°†åœ¨æ‚¨é¦–æ¬¡ç”¨æˆ·ä¼šè¯ç™»å½•æ—¶åº”ç”¨ï¼Œå¹¶åœ¨ä¹‹åæŒç»­å­˜åœ¨ï¼Œé™¤éæ‚¨æ‰‹åŠ¨åœæ­¢ systemd ç”¨æˆ·ã€‚å› æ­¤ï¼Œä¿®æ”¹æ­¤é…ç½®åï¼Œä½¿å…¶ç”Ÿæ•ˆçš„æœ€ç®€å•æ–¹æ³•æ˜¯é‡æ–°å¯åŠ¨ç³»ç»Ÿã€‚

è¯­æ³•ä¸ shell ç±»ä¼¼ï¼Œä½†ä¸éœ€è¦ `export`ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ªåŒ…å«ä»¥ä¸‹å†…å®¹çš„æ–‡ä»¶ `~/.config/environment.d/im.conf`ï¼š

XMODIFIERS=@im=fcitx
GTK_IM_MODULE=fcitx
QT_IM_MODULE=fcitx

### pam_env.so

ç”±äºä»¥ä¸‹åŸå› ï¼Œè¿™æ˜¯ä¸€ä¸ªè¿‡æ—¶çš„è§£å†³æ–¹æ¡ˆï¼š

* pam è‡ª 1.5.0 èµ·å¼ƒç”¨ç”¨æˆ·çº§åˆ«é…ç½® `~/.pam_environment`ã€‚
* æŸäº›å‘è¡Œç‰ˆæœªåœ¨å…¶ pam é…ç½®ä¸­å¯ç”¨ pam_envã€‚

å¦‚æœæ‚¨çŸ¥é“å®ƒé€‚ç”¨äºæ‚¨çš„ç³»ç»Ÿï¼Œæ‚¨å¯ä»¥å°†ä»¥ä¸‹ä»£ç ç‰‡æ®µæ·»åŠ åˆ°æ‚¨çš„ `~/.pam_environment` ä¸­ã€‚

XMODIFIERS DEFAULT=\@im=fcitx
GTK_IM_MODULE DEFAULT=fcitx
QT_IM_MODULE DEFAULT=fcitx.

è¯·**æ³¨æ„**ï¼Œå…¶è¯­æ³•ä¸ shell è„šæœ¬ä¸åŒã€‚

### ~/.config/plasma-workspace/env/*.sh

ä»…é€‚ç”¨äº Plasma æ¡Œé¢çš„ env è„šæœ¬ä½ç½®ï¼Œæ‚¨éœ€è¦åˆ›å»ºè‡ªå·±çš„ .sh æ–‡ä»¶ï¼Œä¾‹å¦‚ `~/.config/plasma-workspace/env/im.sh` å¹¶å°†ä»£ç ç‰‡æ®µä¸[ç™»å½•shellé…ç½®æ–‡ä»¶](https://fcitx-im.org/index.php?title=Special%EF%BC%9AmyLanguage/Setup_Fcitx_5&action=edit&redlink=1 "Specialï¼šmyLanguage/Setup Fcitx 5 (page does not exist)")ã€‚

### å…¶ä»–ä¸å¤ªå¸¸è§çš„è®¾ç½®

è¿˜æœ‰ä¸€äº›å…¶ä»–å˜é‡å¯èƒ½å¯¹æŸäº›åº”ç”¨ç¨‹åºæœ‰ç”¨ã€‚

#### SDL_IM_MODULE

å°†å€¼è®¾ç½®ä¸º fcitxã€‚åªæœ‰ SDL2 éœ€è¦è¿™ä¸ªã€‚SDL1 ä½¿ç”¨ XIMã€‚

#### GLFW_IM_MODULE

è¿™æ˜¯ä»…ç”±[[1]](https://github.com/kovidgoyal/kitty/kitty)ä½¿ç”¨çš„å˜é‡ã€‚æ‚¨éœ€è¦å°†å…¶è®¾ç½®ä¸ºâ€œGLFW_IM_MODULE=ibusâ€ã€‚

#### Binary Qt application

ç”±äº Qt 5 ä¸æ”¯æŒ XIMï¼Œå¹¶ä¸”å®ƒä»…æ†ç»‘ ibus im æ¨¡å—ï¼Œå› æ­¤æ‚¨å¯èƒ½éœ€è¦ä¸ºä¸ä½¿ç”¨ç³»ç»Ÿ Qt åº“çš„ Qt åº”ç”¨ç¨‹åºè®¾ç½®â€œQT_IM_MODULE=ibusâ€ã€‚ ï¼ˆå®ƒå¯èƒ½ä»ç„¶æ— æ³•å·¥ä½œï¼Œå› ä¸ºæŸäº› Qt åº”ç”¨ç¨‹åºç”šè‡³æ²¡æœ‰æ†ç»‘ä»»ä½• IM æ¨¡å—ï¼‰ã€‚

### DBus

åœ¨å¤§å¤šæ•°é™„å¸¦ systemd çš„å‘è¡Œç‰ˆä¸Šï¼Œè¿™åº”è¯¥ä¸å†æ˜¯é—®é¢˜ã€‚ä½†æ˜¯å¦‚æœæ‚¨ä½¿ç”¨ä¸€äº›æ‰€è°“çš„â€œsystemdâ€free 
çš„å‘è¡Œç‰ˆï¼Œæ‚¨å¯èƒ½éœ€è¦è‡ªå·±å¯åŠ¨DBuså¹¶è®¾ç½®ç›¸å…³çš„ç¯å¢ƒå˜é‡ã€‚é€šå¸¸ï¼Œè¿™å¯ä»¥é€šè¿‡åœ¨å¯åŠ¨è„šæœ¬ä¸­æ·»åŠ å¦‚ä¸‹è¡Œæ¥å®Œæˆã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ X11ï¼Œåˆ™ä¸º 
~/.xprofileã€‚æ­¤å¤–ï¼Œæ‚¨è¿˜éœ€è¦ç¡®ä¿æ­¤è¯­æ³•é€‚ç”¨äºæ‚¨çš„ç™»å½• shellã€‚

eval `dbus-launch --sh-syntax --exit-with-session`
